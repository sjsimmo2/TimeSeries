<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Exponential Smoothing | Time Series 1</title>
  <meta name="description" content="Chapter 3 Exponential Smoothing | Time Series 1" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Exponential Smoothing | Time Series 1" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Exponential Smoothing | Time Series 1" />
  
  
  

<meta name="author" content="by Dr. Susan Simmons" />


<meta name="date" content="2025-10-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="arima.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">TimeSeries</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Time series</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#other-plots"><i class="fa fa-check"></i><b>2.1</b> Other plots</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#time-series-decomposition"><i class="fa fa-check"></i><b>2.2</b> Time series decomposition</a></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#stl-features"><i class="fa fa-check"></i><b>2.3</b> STL features</a></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#missing-values"><i class="fa fa-check"></i><b>2.4</b> Missing values</a></li>
<li class="chapter" data-level="2.5" data-path="introduction.html"><a href="introduction.html#python-code-and-results-for-time-series-plot"><i class="fa fa-check"></i><b>2.5</b> Python code and results for Time Series plot</a></li>
<li class="chapter" data-level="2.6" data-path="introduction.html"><a href="introduction.html#sas-code-for-time-series-plot-and-decomposition"><i class="fa fa-check"></i><b>2.6</b> SAS code for time series plot and decomposition</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html"><i class="fa fa-check"></i><b>3</b> Exponential Smoothing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#simple-exponential-smoothing"><i class="fa fa-check"></i><b>3.1</b> Simple Exponential Smoothing</a></li>
<li class="chapter" data-level="3.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-esm"><i class="fa fa-check"></i><b>3.2</b> Holt ESM</a></li>
<li class="chapter" data-level="3.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters"><i class="fa fa-check"></i><b>3.3</b> Holt-Winters</a></li>
<li class="chapter" data-level="3.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#comparing-forecasts"><i class="fa fa-check"></i><b>3.4</b> Comparing forecasts</a></li>
<li class="chapter" data-level="3.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#ets"><i class="fa fa-check"></i><b>3.5</b> ETS</a></li>
<li class="chapter" data-level="3.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#python-code-for-exponential-smoothing"><i class="fa fa-check"></i><b>3.6</b> Python Code for Exponential Smoothing</a></li>
<li class="chapter" data-level="3.7" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#sas-code-for-exponential-smoothing-models"><i class="fa fa-check"></i><b>3.7</b> SAS Code for Exponential Smoothing Models</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="arima.html"><a href="arima.html"><i class="fa fa-check"></i><b>4</b> ARIMA</a>
<ul>
<li class="chapter" data-level="4.1" data-path="arima.html"><a href="arima.html#stationarity"><i class="fa fa-check"></i><b>4.1</b> Stationarity</a></li>
<li class="chapter" data-level="4.2" data-path="arima.html"><a href="arima.html#correlation-functions"><i class="fa fa-check"></i><b>4.2</b> Correlation Functions</a></li>
<li class="chapter" data-level="4.3" data-path="arima.html"><a href="arima.html#autoregressive-models-ar"><i class="fa fa-check"></i><b>4.3</b> AutoRegressive Models (AR)</a></li>
<li class="chapter" data-level="4.4" data-path="arima.html"><a href="arima.html#moving-average-model-ma"><i class="fa fa-check"></i><b>4.4</b> Moving Average model (MA)</a></li>
<li class="chapter" data-level="4.5" data-path="arima.html"><a href="arima.html#white-noise"><i class="fa fa-check"></i><b>4.5</b> White noise</a></li>
<li class="chapter" data-level="4.6" data-path="arima.html"><a href="arima.html#examples"><i class="fa fa-check"></i><b>4.6</b> Examples</a></li>
<li class="chapter" data-level="4.7" data-path="arima.html"><a href="arima.html#forecasting"><i class="fa fa-check"></i><b>4.7</b> Forecasting</a></li>
<li class="chapter" data-level="4.8" data-path="arima.html"><a href="arima.html#trend"><i class="fa fa-check"></i><b>4.8</b> Trend</a></li>
<li class="chapter" data-level="4.9" data-path="arima.html"><a href="arima.html#python-code-for-armaarima-models"><i class="fa fa-check"></i><b>4.9</b> Python Code for ARMA/ARIMA models</a></li>
<li class="chapter" data-level="4.10" data-path="arima.html"><a href="arima.html#sas-code-for-armaarima"><i class="fa fa-check"></i><b>4.10</b> SAS Code for ARMA/ARIMA</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="seasonal-arima.html"><a href="seasonal-arima.html"><i class="fa fa-check"></i><b>5</b> Seasonal ARIMA</a>
<ul>
<li class="chapter" data-level="5.1" data-path="seasonal-arima.html"><a href="seasonal-arima.html#seasonality"><i class="fa fa-check"></i><b>5.1</b> Seasonality</a></li>
<li class="chapter" data-level="5.2" data-path="seasonal-arima.html"><a href="seasonal-arima.html#seasonal-unit-root-testing"><i class="fa fa-check"></i><b>5.2</b> Seasonal “Unit-Root” Testing</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="seasonal-arima.html"><a href="seasonal-arima.html#r"><i class="fa fa-check"></i><b>5.2.1</b> R</a></li>
<li class="chapter" data-level="5.2.2" data-path="seasonal-arima.html"><a href="seasonal-arima.html#python"><i class="fa fa-check"></i><b>5.2.2</b> Python</a></li>
<li class="chapter" data-level="5.2.3" data-path="seasonal-arima.html"><a href="seasonal-arima.html#sas"><i class="fa fa-check"></i><b>5.2.3</b> SAS</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="seasonal-arima.html"><a href="seasonal-arima.html#deterministic-solution"><i class="fa fa-check"></i><b>5.3</b> Deterministic Solution</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="seasonal-arima.html"><a href="seasonal-arima.html#r-1"><i class="fa fa-check"></i><b>5.3.1</b> R</a></li>
<li class="chapter" data-level="5.3.2" data-path="seasonal-arima.html"><a href="seasonal-arima.html#python-1"><i class="fa fa-check"></i><b>5.3.2</b> Python</a></li>
<li class="chapter" data-level="5.3.3" data-path="seasonal-arima.html"><a href="seasonal-arima.html#sas-1"><i class="fa fa-check"></i><b>5.3.3</b> SAS</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="seasonal-arima.html"><a href="seasonal-arima.html#fourier-transformations"><i class="fa fa-check"></i><b>5.4</b> Fourier Transformations</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="seasonal-arima.html"><a href="seasonal-arima.html#r-2"><i class="fa fa-check"></i><b>5.4.1</b> R</a></li>
<li class="chapter" data-level="5.4.2" data-path="seasonal-arima.html"><a href="seasonal-arima.html#python-2"><i class="fa fa-check"></i><b>5.4.2</b> Python</a></li>
<li class="chapter" data-level="5.4.3" data-path="seasonal-arima.html"><a href="seasonal-arima.html#sas-2"><i class="fa fa-check"></i><b>5.4.3</b> SAS</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="seasonal-arima.html"><a href="seasonal-arima.html#other-predictor-variables"><i class="fa fa-check"></i><b>5.5</b> Other Predictor Variables</a></li>
<li class="chapter" data-level="5.6" data-path="seasonal-arima.html"><a href="seasonal-arima.html#stochastic-solution"><i class="fa fa-check"></i><b>5.6</b> Stochastic Solution</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="seasonal-arima.html"><a href="seasonal-arima.html#r-3"><i class="fa fa-check"></i><b>5.6.1</b> R</a></li>
<li class="chapter" data-level="5.6.2" data-path="seasonal-arima.html"><a href="seasonal-arima.html#python-3"><i class="fa fa-check"></i><b>5.6.2</b> Python</a></li>
<li class="chapter" data-level="5.6.3" data-path="seasonal-arima.html"><a href="seasonal-arima.html#sas-3"><i class="fa fa-check"></i><b>5.6.3</b> SAS</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="seasonal-arima.html"><a href="seasonal-arima.html#seasonal-arima-modeling"><i class="fa fa-check"></i><b>5.7</b> Seasonal ARIMA Modeling</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="seasonal-arima.html"><a href="seasonal-arima.html#r-4"><i class="fa fa-check"></i><b>5.7.1</b> R</a></li>
<li class="chapter" data-level="5.7.2" data-path="seasonal-arima.html"><a href="seasonal-arima.html#python-4"><i class="fa fa-check"></i><b>5.7.2</b> Python</a></li>
<li class="chapter" data-level="5.7.3" data-path="seasonal-arima.html"><a href="seasonal-arima.html#sas-4"><i class="fa fa-check"></i><b>5.7.3</b> SAS</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="seasonal-arima.html"><a href="seasonal-arima.html#multiplicative-vs.-additive"><i class="fa fa-check"></i><b>5.8</b> Multiplicative vs. Additive</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Time Series 1</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exponential-smoothing" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Exponential Smoothing<a href="exponential-smoothing.html#exponential-smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We will now get into our first modeling, which are exponential smoothing models. They have been around for quite some time, but can still be useful if interested in one-step ahead forecasting.</p>
<p>In R, we are able to do Simple (or Single) Exponential Smoothing Models, Holt Exponential Smoothing Models and Holt-Winters Exponential Smoothing Models. We will be using the Steel data set and the airline data set to illustrate these models. Each of these are shown below.</p>
<div id="simple-exponential-smoothing" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Simple Exponential Smoothing<a href="exponential-smoothing.html#simple-exponential-smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For Simple Exponential Smoothing Models (SES), we have only one component, referred to as the level component.
<span class="math display">\[\hat{Y}_{t+1}= L_{t}\\
  L_{t} = \alpha Y_{t} + (1-\alpha)L_{t-1}\]</span></p>
<p>This is basically a weighted average with the last observation and the last predicted value. Since this only has a level component, forecasts from SES models will be a horizontal line (hence why this method is called “one-step ahead” forecasting).</p>
<p>Before modeling, be sure to divide your data into a training, validation and test (or at least training and test). The below code illustrates the Simple (Single) Exponential Smoothing Model.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="exponential-smoothing.html#cb36-1" tabindex="-1"></a><span class="co"># Building a Single Exponential Smoothing (SES) Model - Steel Data #</span></span>
<span id="cb36-2"><a href="exponential-smoothing.html#cb36-2" tabindex="-1"></a>Steel <span class="ot">&lt;-</span> Steel <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">&#39;1932-07-01&#39;</span>),<span class="fu">ymd</span>(<span class="st">&#39;1980-01-01&#39;</span>),<span class="at">by=</span><span class="st">&#39;6 months&#39;</span>))</span>
<span id="cb36-3"><a href="exponential-smoothing.html#cb36-3" tabindex="-1"></a></span>
<span id="cb36-4"><a href="exponential-smoothing.html#cb36-4" tabindex="-1"></a>steel_ts<span class="ot">&lt;-</span>Steel <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Month=</span><span class="fu">yearmonth</span>(date)) <span class="sc">|&gt;</span> <span class="fu">as_tsibble</span>(<span class="at">index=</span>Month)</span>
<span id="cb36-5"><a href="exponential-smoothing.html#cb36-5" tabindex="-1"></a></span>
<span id="cb36-6"><a href="exponential-smoothing.html#cb36-6" tabindex="-1"></a>steel_train <span class="ot">&lt;-</span>steel_ts <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">year</span>(date) <span class="sc">&lt;=</span> <span class="dv">1975</span>)</span>
<span id="cb36-7"><a href="exponential-smoothing.html#cb36-7" tabindex="-1"></a></span>
<span id="cb36-8"><a href="exponential-smoothing.html#cb36-8" tabindex="-1"></a>SES.Steel <span class="ot">&lt;-</span> steel_train <span class="sc">|&gt;</span></span>
<span id="cb36-9"><a href="exponential-smoothing.html#cb36-9" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(steelshp <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;N&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>)))</span>
<span id="cb36-10"><a href="exponential-smoothing.html#cb36-10" tabindex="-1"></a>Steel.for <span class="ot">&lt;-</span> SES.Steel <span class="sc">|&gt;</span></span>
<span id="cb36-11"><a href="exponential-smoothing.html#cb36-11" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">9</span>)</span>
<span id="cb36-12"><a href="exponential-smoothing.html#cb36-12" tabindex="-1"></a><span class="fu">report</span>(SES.Steel)</span></code></pre></div>
<pre><code>## Series: steelshp 
## Model: ETS(A,N,N) 
##   Smoothing parameters:
##     alpha = 0.466543 
## 
##   Initial states:
##      l[0]
##  6269.498
## 
##   sigma^2:  214894.3
## 
##      AIC     AICc      BIC 
## 1460.688 1460.977 1468.086</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="exponential-smoothing.html#cb38-1" tabindex="-1"></a><span class="co"># Plot the SES model on steel data</span></span>
<span id="cb38-2"><a href="exponential-smoothing.html#cb38-2" tabindex="-1"></a>Steel.for <span class="sc">|&gt;</span></span>
<span id="cb38-3"><a href="exponential-smoothing.html#cb38-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(steel_ts) <span class="sc">+</span></span>
<span id="cb38-4"><a href="exponential-smoothing.html#cb38-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">col=</span><span class="st">&quot;#D55E00&quot;</span>,</span>
<span id="cb38-5"><a href="exponential-smoothing.html#cb38-5" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">augment</span>(SES.Steel)) <span class="sc">+</span></span>
<span id="cb38-6"><a href="exponential-smoothing.html#cb38-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Steel Exports&quot;</span>, <span class="at">title=</span><span class="st">&quot;Steel Exports&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-7"><a href="exponential-smoothing.html#cb38-7" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/ses-1.png" width="672" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="exponential-smoothing.html#cb39-1" tabindex="-1"></a><span class="co"># To get fitted values for training data set:</span></span>
<span id="cb39-2"><a href="exponential-smoothing.html#cb39-2" tabindex="-1"></a>Steel_fitted <span class="ot">&lt;-</span><span class="fu">fitted</span>(SES.Steel)<span class="sc">$</span>.fitted</span>
<span id="cb39-3"><a href="exponential-smoothing.html#cb39-3" tabindex="-1"></a><span class="co"># To get fitted values for test data set:</span></span>
<span id="cb39-4"><a href="exponential-smoothing.html#cb39-4" tabindex="-1"></a>Steel_test <span class="ot">&lt;-</span> Steel.for<span class="sc">$</span>.mean</span>
<span id="cb39-5"><a href="exponential-smoothing.html#cb39-5" tabindex="-1"></a></span>
<span id="cb39-6"><a href="exponential-smoothing.html#cb39-6" tabindex="-1"></a><span class="co"># Computes accuracy statistics for SES model on steel data (test data)</span></span>
<span id="cb39-7"><a href="exponential-smoothing.html#cb39-7" tabindex="-1"></a>fabletools<span class="sc">::</span><span class="fu">accuracy</span>(Steel.for, steel_ts)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 10
##   .model                                       .type    ME  RMSE   MAE   MPE  MAPE  MASE RMSSE    ACF1
##   &lt;chr&gt;                                        &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 &quot;ETS(steelshp ~ error(\&quot;A\&quot;) + trend(\&quot;N\&quot;)… Test   468.  599.  486.  6.75  7.04  1.17  1.13 -0.0500</code></pre>
</div>
<div id="holt-esm" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Holt ESM<a href="exponential-smoothing.html#holt-esm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Holt model incorporates trend information. So, now there are two components: level and trend. For each component, there will be a smoothing coefficient (or weight). CAREFUL, when you look at parameter estimates, these are NOT the estimates for the mean nor the linear trend…you should be thinking of them as weights (between 0 and 1). The overall form for Holt’s method is:</p>
<p><span class="math display">\[\hat{Y}_{t+h}= L_{t}+hT_{t}\\
  L_{t} = \alpha Y_{t} + (1-\alpha)(L_{t-1}+T_{t-1})\\
  T_{t} = \beta (L_{t}-L_{t-1}) + (1-\beta) T_{t-1}\]</span></p>
<p>For the Holt’s method, when you forecast, you will see a trending line.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="exponential-smoothing.html#cb41-1" tabindex="-1"></a><span class="co"># Building a Linear Exponential Smoothing Model - US Airlines Data #</span></span>
<span id="cb41-2"><a href="exponential-smoothing.html#cb41-2" tabindex="-1"></a></span>
<span id="cb41-3"><a href="exponential-smoothing.html#cb41-3" tabindex="-1"></a>USAirlines_ts <span class="ot">&lt;-</span> USAirlines <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">date=</span><span class="fu">myd</span>(<span class="fu">paste</span>(Month, Year, <span class="st">&quot;1&quot;</span>))) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Month2=</span><span class="fu">yearmonth</span>(date)) <span class="sc">|&gt;</span> <span class="fu">as_tsibble</span>(<span class="at">index=</span>Month2)</span>
<span id="cb41-4"><a href="exponential-smoothing.html#cb41-4" tabindex="-1"></a></span>
<span id="cb41-5"><a href="exponential-smoothing.html#cb41-5" tabindex="-1"></a>air_train <span class="ot">&lt;-</span>USAirlines_ts <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">year</span>(date) <span class="sc">&lt;=</span> <span class="dv">2005</span>)</span>
<span id="cb41-6"><a href="exponential-smoothing.html#cb41-6" tabindex="-1"></a></span>
<span id="cb41-7"><a href="exponential-smoothing.html#cb41-7" tabindex="-1"></a>LES.air <span class="ot">&lt;-</span> air_train <span class="sc">|&gt;</span></span>
<span id="cb41-8"><a href="exponential-smoothing.html#cb41-8" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Passengers <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>)))</span>
<span id="cb41-9"><a href="exponential-smoothing.html#cb41-9" tabindex="-1"></a>air.for <span class="ot">&lt;-</span> LES.air <span class="sc">|&gt;</span></span>
<span id="cb41-10"><a href="exponential-smoothing.html#cb41-10" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">27</span>)</span>
<span id="cb41-11"><a href="exponential-smoothing.html#cb41-11" tabindex="-1"></a><span class="fu">report</span>(LES.air)</span></code></pre></div>
<pre><code>## Series: Passengers 
## Model: ETS(A,A,N) 
##   Smoothing parameters:
##     alpha = 0.5860139 
##     beta  = 0.003740218 
## 
##   Initial states:
##      l[0]     b[0]
##  37303.09 526.6595
## 
##   sigma^2:  23188824
## 
##      AIC     AICc      BIC 
## 4271.560 4271.882 4287.847</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="exponential-smoothing.html#cb43-1" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb43-2"><a href="exponential-smoothing.html#cb43-2" tabindex="-1"></a>air.for <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="exponential-smoothing.html#cb43-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(USAirlines_ts) <span class="sc">+</span></span>
<span id="cb43-4"><a href="exponential-smoothing.html#cb43-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">col=</span><span class="st">&quot;#D55E00&quot;</span>,</span>
<span id="cb43-5"><a href="exponential-smoothing.html#cb43-5" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">augment</span>(LES.air)) <span class="sc">+</span></span>
<span id="cb43-6"><a href="exponential-smoothing.html#cb43-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Passengers&quot;</span>, <span class="at">title=</span><span class="st">&quot;US Airline Passengers&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-7"><a href="exponential-smoothing.html#cb43-7" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Holt-1.png" width="672" /></p>
<p>We can also perform Holt’s method with a damped trend. You will see the formula for the damped trend is similar to the previous Holt formula with an addition of a dampening parameter.</p>
<p><span class="math display">\[\hat{Y}_{t+h}= L_{t}+\sum_{i}^{k}\phi^{i}T_{t}\\
  L_{t} = \alpha Y_{t} + (1-\alpha)(L_{t-1}+\phi T_{t-1})\\
  T_{t} = \beta (L_{t}-L_{t-1}) + (1-\beta) \phi T_{t-1}\]</span></p>
<p>We will illustrate the damped trend on the Airline data set.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="exponential-smoothing.html#cb44-1" tabindex="-1"></a>LdES.air <span class="ot">&lt;-</span> air_train <span class="sc">|&gt;</span></span>
<span id="cb44-2"><a href="exponential-smoothing.html#cb44-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Passengers <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;Ad&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>)))</span>
<span id="cb44-3"><a href="exponential-smoothing.html#cb44-3" tabindex="-1"></a>air.for <span class="ot">&lt;-</span> LdES.air <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="exponential-smoothing.html#cb44-4" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">27</span>)</span>
<span id="cb44-5"><a href="exponential-smoothing.html#cb44-5" tabindex="-1"></a><span class="fu">report</span>(LdES.air)</span></code></pre></div>
<pre><code>## Series: Passengers 
## Model: ETS(A,Ad,N) 
##   Smoothing parameters:
##     alpha = 0.5705768 
##     beta  = 0.0001003564 
##     phi   = 0.8085131 
## 
##   Initial states:
##      l[0]     b[0]
##  36885.52 526.5046
## 
##   sigma^2:  23007825
## 
##      AIC     AICc      BIC 
## 4271.031 4271.485 4290.576</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="exponential-smoothing.html#cb46-1" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb46-2"><a href="exponential-smoothing.html#cb46-2" tabindex="-1"></a>air.for <span class="sc">|&gt;</span></span>
<span id="cb46-3"><a href="exponential-smoothing.html#cb46-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(USAirlines_ts) <span class="sc">+</span></span>
<span id="cb46-4"><a href="exponential-smoothing.html#cb46-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">col=</span><span class="st">&quot;#D55E00&quot;</span>,</span>
<span id="cb46-5"><a href="exponential-smoothing.html#cb46-5" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">augment</span>(LdES.air)) <span class="sc">+</span></span>
<span id="cb46-6"><a href="exponential-smoothing.html#cb46-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Passengers&quot;</span>, <span class="at">title=</span><span class="st">&quot;US Airline Passengers&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-7"><a href="exponential-smoothing.html#cb46-7" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/damped%20trend-1.png" width="672" /></p>
</div>
<div id="holt-winters" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Holt-Winters<a href="exponential-smoothing.html#holt-winters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Holt-Winters (HW) model has three components to it (level, trend and seasonality). Seasonality is an interesting component to model since we can have an additive seasonal component or a multiplicative seasonal component. Both models are shown below:</p>
<p>Additive HW
<span class="math display">\[\hat{Y}_{t+h}= L_{t}+hT_{t} + S_{t-p+h}\\
  L_{t} = \alpha (Y_{t} - S_{t-p}) + (1-\alpha)(L_{t-1}+T_{t-1})\\
  T_{t} = \beta (L_{t}-L_{t-1}) + (1-\beta) T_{t-1}\\
  S_{t} = \gamma (Y_{t}-L_{t-1}-T_{t-1}) + (1-\gamma) S_{t-p}\]</span></p>
<p>Multiplicative HW
<span class="math display">\[\hat{Y}_{t+h}= (L_{t}+hT_{t}) S_{t-p+h}\\
  L_{t} = \alpha \frac{Y_{t}} {S_{t-p}} + (1-\alpha)(L_{t-1}+T_{t-1})\\
  T_{t} = \beta (L_{t}-L_{t-1}) + (1-\beta) T_{t-1}\\
  S_{t} = \gamma \frac{Y_{t}}{L_{t-1}+T_{t-1}} + (1-\gamma) S_{t-p}\]</span></p>
<p>Where p is the frequency of the seasonality (i.e. how many “seasons” there are within one year).</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="exponential-smoothing.html#cb47-1" tabindex="-1"></a><span class="co"># Building a Holt-Winters ESM - US Airlines Data - Additive Seasonality</span></span>
<span id="cb47-2"><a href="exponential-smoothing.html#cb47-2" tabindex="-1"></a></span>
<span id="cb47-3"><a href="exponential-smoothing.html#cb47-3" tabindex="-1"></a>HWadd.air <span class="ot">&lt;-</span> air_train <span class="sc">|&gt;</span></span>
<span id="cb47-4"><a href="exponential-smoothing.html#cb47-4" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Passengers <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;A&quot;</span>)))</span>
<span id="cb47-5"><a href="exponential-smoothing.html#cb47-5" tabindex="-1"></a>air.for <span class="ot">&lt;-</span> HWadd.air <span class="sc">|&gt;</span></span>
<span id="cb47-6"><a href="exponential-smoothing.html#cb47-6" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">27</span>)</span>
<span id="cb47-7"><a href="exponential-smoothing.html#cb47-7" tabindex="-1"></a><span class="fu">report</span>(HWadd.air)</span></code></pre></div>
<pre><code>## Series: Passengers 
## Model: ETS(A,A,A) 
##   Smoothing parameters:
##     alpha = 0.5913618 
##     beta  = 0.0001002723 
##     gamma = 0.0001000455 
## 
##   Initial states:
##   l[0]     b[0]      s[0]     s[-1]     s[-2]     s[-3]    s[-4]    s[-5]    s[-6]    s[-7]    s[-8]
##  38409 159.5944 -1520.744 -2728.928 -117.3477 -4305.732 6420.735 6299.852 4002.381 1210.882 122.2352
##     s[-9]    s[-10]    s[-11]
##  2660.169 -6471.051 -5572.452
## 
##   sigma^2:  4099578
## 
##      AIC     AICc      BIC 
## 3950.201 3953.718 4005.578</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="exponential-smoothing.html#cb49-1" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb49-2"><a href="exponential-smoothing.html#cb49-2" tabindex="-1"></a>air.for <span class="sc">|&gt;</span></span>
<span id="cb49-3"><a href="exponential-smoothing.html#cb49-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(USAirlines_ts) <span class="sc">+</span></span>
<span id="cb49-4"><a href="exponential-smoothing.html#cb49-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">col=</span><span class="st">&quot;#D55E00&quot;</span>,</span>
<span id="cb49-5"><a href="exponential-smoothing.html#cb49-5" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">augment</span>(HWadd.air)) <span class="sc">+</span></span>
<span id="cb49-6"><a href="exponential-smoothing.html#cb49-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Passengers&quot;</span>, <span class="at">title=</span><span class="st">&quot;US Airline Passengers&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-7"><a href="exponential-smoothing.html#cb49-7" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Seasonal%20models-1.png" width="672" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="exponential-smoothing.html#cb50-1" tabindex="-1"></a><span class="do">### Multiplicative model</span></span>
<span id="cb50-2"><a href="exponential-smoothing.html#cb50-2" tabindex="-1"></a>HWmult.air <span class="ot">&lt;-</span> air_train <span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href="exponential-smoothing.html#cb50-3" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Passengers <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;M&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;M&quot;</span>)))</span>
<span id="cb50-4"><a href="exponential-smoothing.html#cb50-4" tabindex="-1"></a>air.for <span class="ot">&lt;-</span> HWmult.air <span class="sc">|&gt;</span></span>
<span id="cb50-5"><a href="exponential-smoothing.html#cb50-5" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">27</span>)</span>
<span id="cb50-6"><a href="exponential-smoothing.html#cb50-6" tabindex="-1"></a><span class="fu">report</span>(HWmult.air)</span></code></pre></div>
<pre><code>## Series: Passengers 
## Model: ETS(M,A,M) 
##   Smoothing parameters:
##     alpha = 0.5132388 
##     beta  = 0.006772624 
##     gamma = 0.0614166 
## 
##   Initial states:
##      l[0]     b[0]      s[0]     s[-1]    s[-2]     s[-3]    s[-4]    s[-5]    s[-6]    s[-7]
##  38328.12 132.2916 0.9879613 0.9516784 1.015964 0.9248462 1.127338 1.111153 1.063682 1.012367
##      s[-8]    s[-9]    s[-10]    s[-11]
##  0.9931891 1.041972 0.8832477 0.8866022
## 
##   sigma^2:  0.0015
## 
##      AIC     AICc      BIC 
## 3922.549 3926.066 3977.926</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="exponential-smoothing.html#cb52-1" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb52-2"><a href="exponential-smoothing.html#cb52-2" tabindex="-1"></a>air.for <span class="sc">|&gt;</span></span>
<span id="cb52-3"><a href="exponential-smoothing.html#cb52-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(USAirlines_ts) <span class="sc">+</span></span>
<span id="cb52-4"><a href="exponential-smoothing.html#cb52-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">col=</span><span class="st">&quot;#D55E00&quot;</span>,</span>
<span id="cb52-5"><a href="exponential-smoothing.html#cb52-5" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">augment</span>(HWmult.air)) <span class="sc">+</span></span>
<span id="cb52-6"><a href="exponential-smoothing.html#cb52-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Passengers&quot;</span>, <span class="at">title=</span><span class="st">&quot;US Airline Passengers&quot;</span>) <span class="sc">+</span></span>
<span id="cb52-7"><a href="exponential-smoothing.html#cb52-7" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Seasonal%20models-2.png" width="672" /></p>
</div>
<div id="comparing-forecasts" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Comparing forecasts<a href="exponential-smoothing.html#comparing-forecasts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This should be done on the validation data set (test data should ONLY be used ONCE…at the very end).</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="exponential-smoothing.html#cb53-1" tabindex="-1"></a>air_fit <span class="ot">&lt;-</span> air_train <span class="sc">|&gt;</span></span>
<span id="cb53-2"><a href="exponential-smoothing.html#cb53-2" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb53-3"><a href="exponential-smoothing.html#cb53-3" tabindex="-1"></a>    <span class="at">SES =</span> <span class="fu">ETS</span>(Passengers <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;N&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>)),</span>
<span id="cb53-4"><a href="exponential-smoothing.html#cb53-4" tabindex="-1"></a>    <span class="st">`</span><span class="at">Linear</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ETS</span>(Passengers <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>)),</span>
<span id="cb53-5"><a href="exponential-smoothing.html#cb53-5" tabindex="-1"></a>    <span class="st">`</span><span class="at">Damped Linear</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ETS</span>(Passengers <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;Ad&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>)),</span>
<span id="cb53-6"><a href="exponential-smoothing.html#cb53-6" tabindex="-1"></a>    <span class="at">HWAdd =</span> <span class="fu">ETS</span>(Passengers <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;A&quot;</span>)),</span>
<span id="cb53-7"><a href="exponential-smoothing.html#cb53-7" tabindex="-1"></a>    <span class="at">HWMult =</span> <span class="fu">ETS</span>(Passengers <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;M&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;M&quot;</span>))</span>
<span id="cb53-8"><a href="exponential-smoothing.html#cb53-8" tabindex="-1"></a>  )</span>
<span id="cb53-9"><a href="exponential-smoothing.html#cb53-9" tabindex="-1"></a></span>
<span id="cb53-10"><a href="exponential-smoothing.html#cb53-10" tabindex="-1"></a>air_fc <span class="ot">&lt;-</span> air_fit <span class="sc">|&gt;</span></span>
<span id="cb53-11"><a href="exponential-smoothing.html#cb53-11" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">27</span>)</span>
<span id="cb53-12"><a href="exponential-smoothing.html#cb53-12" tabindex="-1"></a></span>
<span id="cb53-13"><a href="exponential-smoothing.html#cb53-13" tabindex="-1"></a></span>
<span id="cb53-14"><a href="exponential-smoothing.html#cb53-14" tabindex="-1"></a>fabletools<span class="sc">::</span><span class="fu">accuracy</span>(air_fc, USAirlines_ts)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 10
##   .model        .type     ME  RMSE   MAE    MPE  MAPE  MASE RMSSE  ACF1
##   &lt;chr&gt;         &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Damped Linear Test  3351.  6251. 5238.  4.65   8.06 1.84  1.69  0.382
## 2 HWAdd         Test  -175.  1462. 1259. -0.421  2.02 0.443 0.395 0.448
## 3 HWMult        Test   467.  1319. 1110.  0.705  1.75 0.391 0.356 0.219
## 4 Linear        Test   -67.3 5345. 4736. -0.789  7.62 1.67  1.44  0.436
## 5 SES           Test  3346.  6248. 5236.  4.64   8.05 1.84  1.69  0.382</code></pre>
<p>Based upone this information, which model would you choose?</p>
</div>
<div id="ets" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> ETS<a href="exponential-smoothing.html#ets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can also allow the computer to search for the best model. The ETS (Error, Trend, Seasonality) algorithm will search for the best model and estimate the parameters. For the error term, we can have either an additive or multiplicative error structure. For the trend, we can have none, additive, or damped additive . For the seasonal component, we can have none, additive or multiplicative (lots of choices!). An example of how to run this is:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="exponential-smoothing.html#cb55-1" tabindex="-1"></a>air_auto <span class="ot">&lt;-</span> air_train <span class="sc">|&gt;</span></span>
<span id="cb55-2"><a href="exponential-smoothing.html#cb55-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Passengers))</span>
<span id="cb55-3"><a href="exponential-smoothing.html#cb55-3" tabindex="-1"></a><span class="fu">report</span>(air_auto)</span></code></pre></div>
<pre><code>## Series: Passengers 
## Model: ETS(M,Ad,M) 
##   Smoothing parameters:
##     alpha = 0.6388447 
##     beta  = 0.0001026043 
##     gamma = 0.0001060611 
##     phi   = 0.979993 
## 
##   Initial states:
##      l[0]     b[0]      s[0]     s[-1]     s[-2]     s[-3]    s[-4]    s[-5]    s[-6]    s[-7]
##  38326.08 97.13345 0.9672127 0.9438917 0.9983376 0.9209977 1.132478 1.132414 1.079442 1.022098
##     s[-8]    s[-9]    s[-10]    s[-11]
##  1.000804 1.051137 0.8657376 0.8854499
## 
##   sigma^2:  0.0014
## 
##      AIC     AICc      BIC 
## 3910.149 3914.103 3968.784</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="exponential-smoothing.html#cb57-1" tabindex="-1"></a><span class="co"># Now compare this to the HW models:</span></span>
<span id="cb57-2"><a href="exponential-smoothing.html#cb57-2" tabindex="-1"></a></span>
<span id="cb57-3"><a href="exponential-smoothing.html#cb57-3" tabindex="-1"></a>air_fit <span class="ot">&lt;-</span> air_train <span class="sc">|&gt;</span></span>
<span id="cb57-4"><a href="exponential-smoothing.html#cb57-4" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb57-5"><a href="exponential-smoothing.html#cb57-5" tabindex="-1"></a>    <span class="at">HWAdd =</span> <span class="fu">ETS</span>(Passengers <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;A&quot;</span>)),</span>
<span id="cb57-6"><a href="exponential-smoothing.html#cb57-6" tabindex="-1"></a>    <span class="at">HWMult =</span> <span class="fu">ETS</span>(Passengers <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;M&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;M&quot;</span>)),</span>
<span id="cb57-7"><a href="exponential-smoothing.html#cb57-7" tabindex="-1"></a>    <span class="at">AutoETS =</span> <span class="fu">ETS</span>(Passengers <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;M&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;Ad&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;M&quot;</span>))</span>
<span id="cb57-8"><a href="exponential-smoothing.html#cb57-8" tabindex="-1"></a>  )</span>
<span id="cb57-9"><a href="exponential-smoothing.html#cb57-9" tabindex="-1"></a></span>
<span id="cb57-10"><a href="exponential-smoothing.html#cb57-10" tabindex="-1"></a>air_fc <span class="ot">&lt;-</span> air_fit <span class="sc">|&gt;</span></span>
<span id="cb57-11"><a href="exponential-smoothing.html#cb57-11" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">27</span>)</span>
<span id="cb57-12"><a href="exponential-smoothing.html#cb57-12" tabindex="-1"></a></span>
<span id="cb57-13"><a href="exponential-smoothing.html#cb57-13" tabindex="-1"></a></span>
<span id="cb57-14"><a href="exponential-smoothing.html#cb57-14" tabindex="-1"></a>fabletools<span class="sc">::</span><span class="fu">accuracy</span>(air_fc, USAirlines_ts)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 10
##   .model  .type    ME  RMSE   MAE    MPE  MAPE  MASE RMSSE  ACF1
##   &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 AutoETS Test  1734. 2343. 2020.  2.75   3.19 0.711 0.633 0.596
## 2 HWAdd   Test  -175. 1462. 1259. -0.421  2.02 0.443 0.395 0.448
## 3 HWMult  Test   467. 1319. 1110.  0.705  1.75 0.391 0.356 0.219</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="exponential-smoothing.html#cb59-1" tabindex="-1"></a><span class="do">### Can change to bic</span></span>
<span id="cb59-2"><a href="exponential-smoothing.html#cb59-2" tabindex="-1"></a>air_auto2 <span class="ot">&lt;-</span> air_train <span class="sc">|&gt;</span></span>
<span id="cb59-3"><a href="exponential-smoothing.html#cb59-3" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Passengers, <span class="at">ic =</span><span class="st">&quot;bic&quot;</span>))</span>
<span id="cb59-4"><a href="exponential-smoothing.html#cb59-4" tabindex="-1"></a><span class="fu">report</span>(air_auto2)</span></code></pre></div>
<pre><code>## Series: Passengers 
## Model: ETS(M,N,M) 
##   Smoothing parameters:
##     alpha = 0.7358545 
##     gamma = 0.001388497 
## 
##   Initial states:
##      l[0]      s[0]     s[-1]     s[-2]     s[-3]    s[-4]    s[-5]    s[-6]    s[-7]    s[-8]
##  41491.07 0.9705455 0.9480705 0.9988812 0.9158342 1.119004 1.126052 1.073332 1.022722 1.003232
##     s[-9]    s[-10]    s[-11]
##  1.057297 0.8713743 0.8936557
## 
##   sigma^2:  0.0015
## 
##      AIC     AICc      BIC 
## 3912.504 3915.231 3961.366</code></pre>
</div>
<div id="python-code-for-exponential-smoothing" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Python Code for Exponential Smoothing<a href="exponential-smoothing.html#python-code-for-exponential-smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following Python codes will produce exponential smoothing models. The exponential smoothing models are using an older version in statsmodels (a new format is in statsforecast).</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="exponential-smoothing.html#cb61-1" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb61-2"><a href="exponential-smoothing.html#cb61-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb61-3"><a href="exponential-smoothing.html#cb61-3" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb61-4"><a href="exponential-smoothing.html#cb61-4" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot</span>
<span id="cb61-5"><a href="exponential-smoothing.html#cb61-5" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb61-6"><a href="exponential-smoothing.html#cb61-6" tabindex="-1"></a><span class="im">from</span> statsforecast.models <span class="im">import</span> ETS</span>
<span id="cb61-7"><a href="exponential-smoothing.html#cb61-7" tabindex="-1"></a><span class="im">from</span> statsforecast <span class="im">import</span> StatsForecast</span>
<span id="cb61-8"><a href="exponential-smoothing.html#cb61-8" tabindex="-1"></a><span class="im">from</span> statsforecast.utils <span class="im">import</span> AirPassengers</span>
<span id="cb61-9"><a href="exponential-smoothing.html#cb61-9" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.tsatools <span class="im">import</span> detrend</span>
<span id="cb61-10"><a href="exponential-smoothing.html#cb61-10" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb61-11"><a href="exponential-smoothing.html#cb61-11" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.api <span class="im">import</span> ExponentialSmoothing, SimpleExpSmoothing, Holt</span>
<span id="cb61-12"><a href="exponential-smoothing.html#cb61-12" tabindex="-1"></a><span class="im">from</span> statsforecast.models <span class="im">import</span> AutoETS</span>
<span id="cb61-13"><a href="exponential-smoothing.html#cb61-13" tabindex="-1"></a></span>
<span id="cb61-14"><a href="exponential-smoothing.html#cb61-14" tabindex="-1"></a></span>
<span id="cb61-15"><a href="exponential-smoothing.html#cb61-15" tabindex="-1"></a>steel<span class="op">=</span>pd.read_csv(<span class="st">&quot;Q:</span><span class="ch">\\</span><span class="st">My Drive</span><span class="ch">\\</span><span class="st">Fall 2017 - Time Series</span><span class="ch">\\</span><span class="st">DataR</span><span class="ch">\\</span><span class="st">steel.csv&quot;</span>)</span>
<span id="cb61-16"><a href="exponential-smoothing.html#cb61-16" tabindex="-1"></a>df <span class="op">=</span> pd.date_range(start<span class="op">=</span><span class="st">&#39;1932-07-01&#39;</span>, end<span class="op">=</span><span class="st">&#39;1980-07-01&#39;</span>, freq<span class="op">=</span><span class="st">&#39;6ME&#39;</span>)</span>
<span id="cb61-17"><a href="exponential-smoothing.html#cb61-17" tabindex="-1"></a>steel.index<span class="op">=</span>pd.to_datetime(df)</span>
<span id="cb61-18"><a href="exponential-smoothing.html#cb61-18" tabindex="-1"></a></span>
<span id="cb61-19"><a href="exponential-smoothing.html#cb61-19" tabindex="-1"></a>steel_train<span class="op">=</span>steel.head(<span class="dv">87</span>)</span>
<span id="cb61-20"><a href="exponential-smoothing.html#cb61-20" tabindex="-1"></a>steel_test <span class="op">=</span> steel.tail(<span class="dv">9</span>)</span>
<span id="cb61-21"><a href="exponential-smoothing.html#cb61-21" tabindex="-1"></a></span>
<span id="cb61-22"><a href="exponential-smoothing.html#cb61-22" tabindex="-1"></a>fit <span class="op">=</span> SimpleExpSmoothing(steel_train[<span class="st">&#39;steelshp&#39;</span>]).fit()</span>
<span id="cb61-23"><a href="exponential-smoothing.html#cb61-23" tabindex="-1"></a>fit.params[<span class="st">&#39;smoothing_level&#39;</span>]</span></code></pre></div>
<pre><code>## 0.4769767441860465</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="exponential-smoothing.html#cb63-1" tabindex="-1"></a>fcast <span class="op">=</span> fit.forecast(<span class="dv">9</span>)</span>
<span id="cb63-2"><a href="exponential-smoothing.html#cb63-2" tabindex="-1"></a>fcast</span></code></pre></div>
<pre><code>## 1976-01-31    6188.807035
## 1976-07-31    6188.807035
## 1977-01-31    6188.807035
## 1977-07-31    6188.807035
## 1978-01-31    6188.807035
## 1978-07-31    6188.807035
## 1979-01-31    6188.807035
## 1979-07-31    6188.807035
## 1980-01-31    6188.807035
## Freq: 6ME, dtype: float64</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="exponential-smoothing.html#cb65-1" tabindex="-1"></a>plt.plot(steel_train[<span class="st">&quot;steelshp&quot;</span>],color<span class="op">=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb65-2"><a href="exponential-smoothing.html#cb65-2" tabindex="-1"></a>plt.plot(fcast,color<span class="op">=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb65-3"><a href="exponential-smoothing.html#cb65-3" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/simple%20exponential%20smoothing-1.png" width="672" /></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="exponential-smoothing.html#cb66-1" tabindex="-1"></a><span class="co">##### Using Statsforecast</span></span>
<span id="cb66-2"><a href="exponential-smoothing.html#cb66-2" tabindex="-1"></a></span>
<span id="cb66-3"><a href="exponential-smoothing.html#cb66-3" tabindex="-1"></a></span>
<span id="cb66-4"><a href="exponential-smoothing.html#cb66-4" tabindex="-1"></a>d <span class="op">=</span> {<span class="st">&#39;unique_id&#39;</span>: <span class="dv">1</span>, <span class="st">&#39;ds&#39;</span>: steel.index, <span class="st">&#39;y&#39;</span>: steel[<span class="st">&#39;steelshp&#39;</span>]}</span>
<span id="cb66-5"><a href="exponential-smoothing.html#cb66-5" tabindex="-1"></a>steel_sf <span class="op">=</span> pd.DataFrame(data <span class="op">=</span> d)</span>
<span id="cb66-6"><a href="exponential-smoothing.html#cb66-6" tabindex="-1"></a></span>
<span id="cb66-7"><a href="exponential-smoothing.html#cb66-7" tabindex="-1"></a>steel_train<span class="op">=</span>steel_sf.head(<span class="dv">87</span>)</span>
<span id="cb66-8"><a href="exponential-smoothing.html#cb66-8" tabindex="-1"></a>steel_test <span class="op">=</span> steel_sf.tail(<span class="dv">9</span>)</span>
<span id="cb66-9"><a href="exponential-smoothing.html#cb66-9" tabindex="-1"></a></span>
<span id="cb66-10"><a href="exponential-smoothing.html#cb66-10" tabindex="-1"></a>steel_SES <span class="op">=</span> StatsForecast(models <span class="op">=</span> [AutoETS(model<span class="op">=</span>[<span class="st">&quot;A&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>],  alias<span class="op">=</span><span class="st">&quot;AutoETS&quot;</span>, season_length<span class="op">=</span><span class="dv">2</span>)], freq <span class="op">=</span> <span class="st">&#39;6ME&#39;</span>)</span>
<span id="cb66-11"><a href="exponential-smoothing.html#cb66-11" tabindex="-1"></a>steel_model <span class="op">=</span> steel_SES.fit(df <span class="op">=</span> steel_train)</span>
<span id="cb66-12"><a href="exponential-smoothing.html#cb66-12" tabindex="-1"></a></span>
<span id="cb66-13"><a href="exponential-smoothing.html#cb66-13" tabindex="-1"></a>result <span class="op">=</span> steel_SES.fitted_[<span class="dv">0</span>,<span class="dv">0</span>].model_[<span class="st">&#39;par&#39;</span>]</span>
<span id="cb66-14"><a href="exponential-smoothing.html#cb66-14" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## array([4.66739272e-01,            nan,            nan,            nan,
##        6.27096958e+03])</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="exponential-smoothing.html#cb68-1" tabindex="-1"></a>y_hat1<span class="op">=</span>steel_model.predict(h<span class="op">=</span><span class="dv">9</span>)</span></code></pre></div>
<pre><code>## C:\PROGRA~3\ANACON~1\Lib\site-packages\statsforecast\core.py:492: FutureWarning: In a future version the predictions will have the id as a column. You can set the `NIXTLA_ID_AS_COL` environment variable to adopt the new behavior and to suppress this warning.
##   warnings.warn(</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="exponential-smoothing.html#cb70-1" tabindex="-1"></a>yhat<span class="op">=</span>y_hat1.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb70-2"><a href="exponential-smoothing.html#cb70-2" tabindex="-1"></a>forecast<span class="op">=</span>pd.Series(pd.date_range(<span class="st">&quot;1976-01-31&quot;</span>, freq<span class="op">=</span><span class="st">&quot;6ME&quot;</span>, periods<span class="op">=</span><span class="dv">9</span>))</span>
<span id="cb70-3"><a href="exponential-smoothing.html#cb70-3" tabindex="-1"></a>forecast<span class="op">=</span>pd.DataFrame(forecast)</span>
<span id="cb70-4"><a href="exponential-smoothing.html#cb70-4" tabindex="-1"></a>forecast.columns<span class="op">=</span>[<span class="st">&quot;ds&quot;</span>]</span>
<span id="cb70-5"><a href="exponential-smoothing.html#cb70-5" tabindex="-1"></a>forecast[<span class="st">&quot;hat&quot;</span>]<span class="op">=</span>yhat[<span class="st">&#39;AutoETS&#39;</span>]</span>
<span id="cb70-6"><a href="exponential-smoothing.html#cb70-6" tabindex="-1"></a>forecast[<span class="st">&quot;unique_id&quot;</span>]<span class="op">=</span><span class="st">&quot;1&quot;</span></span>
<span id="cb70-7"><a href="exponential-smoothing.html#cb70-7" tabindex="-1"></a>sns.lineplot(steel_train,x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;y&quot;</span>, label<span class="op">=</span><span class="st">&quot;Train&quot;</span>)</span>
<span id="cb70-8"><a href="exponential-smoothing.html#cb70-8" tabindex="-1"></a>sns.lineplot(steel_test, x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;y&quot;</span>, label<span class="op">=</span><span class="st">&quot;Test&quot;</span>)</span>
<span id="cb70-9"><a href="exponential-smoothing.html#cb70-9" tabindex="-1"></a>sns.lineplot(forecast,x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;hat&quot;</span>, label<span class="op">=</span><span class="st">&quot;Forecast&quot;</span>,)</span>
<span id="cb70-10"><a href="exponential-smoothing.html#cb70-10" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/simple%20exponential%20smoothing-2.png" width="672" /></p>
<p>The Holt models in Python:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="exponential-smoothing.html#cb71-1" tabindex="-1"></a><span class="co">#### This code uses the new Statsforecast package</span></span>
<span id="cb71-2"><a href="exponential-smoothing.html#cb71-2" tabindex="-1"></a></span>
<span id="cb71-3"><a href="exponential-smoothing.html#cb71-3" tabindex="-1"></a><span class="co">### Holt Model</span></span>
<span id="cb71-4"><a href="exponential-smoothing.html#cb71-4" tabindex="-1"></a></span>
<span id="cb71-5"><a href="exponential-smoothing.html#cb71-5" tabindex="-1"></a>usair_p<span class="op">=</span>pd.read_csv(<span class="st">&quot;Q:</span><span class="ch">\\</span><span class="st">My Drive</span><span class="ch">\\</span><span class="st">Fall 2017 - Time Series</span><span class="ch">\\</span><span class="st">DataR</span><span class="ch">\\</span><span class="st">usairlines.csv&quot;</span>)</span>
<span id="cb71-6"><a href="exponential-smoothing.html#cb71-6" tabindex="-1"></a>df<span class="op">=</span>pd.date_range(start<span class="op">=</span><span class="st">&#39;1/1/1990&#39;</span>, end<span class="op">=</span><span class="st">&#39;3/1/2008&#39;</span>, freq<span class="op">=</span><span class="st">&#39;MS&#39;</span>)</span>
<span id="cb71-7"><a href="exponential-smoothing.html#cb71-7" tabindex="-1"></a>usair_p.index<span class="op">=</span>pd.to_datetime(df)</span>
<span id="cb71-8"><a href="exponential-smoothing.html#cb71-8" tabindex="-1"></a></span>
<span id="cb71-9"><a href="exponential-smoothing.html#cb71-9" tabindex="-1"></a></span>
<span id="cb71-10"><a href="exponential-smoothing.html#cb71-10" tabindex="-1"></a>d <span class="op">=</span> {<span class="st">&#39;unique_id&#39;</span>: <span class="dv">1</span>, <span class="st">&#39;ds&#39;</span>: usair_p.index, <span class="st">&#39;y&#39;</span>: usair_p[<span class="st">&#39;Passengers&#39;</span>]}</span>
<span id="cb71-11"><a href="exponential-smoothing.html#cb71-11" tabindex="-1"></a>usair_sf <span class="op">=</span> pd.DataFrame(data <span class="op">=</span> d)</span>
<span id="cb71-12"><a href="exponential-smoothing.html#cb71-12" tabindex="-1"></a></span>
<span id="cb71-13"><a href="exponential-smoothing.html#cb71-13" tabindex="-1"></a><span class="co">### train has 192 observations</span></span>
<span id="cb71-14"><a href="exponential-smoothing.html#cb71-14" tabindex="-1"></a><span class="co">### test has 27 observations</span></span>
<span id="cb71-15"><a href="exponential-smoothing.html#cb71-15" tabindex="-1"></a></span>
<span id="cb71-16"><a href="exponential-smoothing.html#cb71-16" tabindex="-1"></a>air_train <span class="op">=</span> usair_sf.head(<span class="dv">192</span>)</span>
<span id="cb71-17"><a href="exponential-smoothing.html#cb71-17" tabindex="-1"></a>air_test <span class="op">=</span> usair_sf.tail(<span class="dv">27</span>)</span>
<span id="cb71-18"><a href="exponential-smoothing.html#cb71-18" tabindex="-1"></a></span>
<span id="cb71-19"><a href="exponential-smoothing.html#cb71-19" tabindex="-1"></a>air_holt <span class="op">=</span> StatsForecast(models <span class="op">=</span> [AutoETS(model<span class="op">=</span>[<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;N&quot;</span>],  alias<span class="op">=</span><span class="st">&quot;AutoETS&quot;</span>, season_length<span class="op">=</span><span class="dv">12</span>)], freq <span class="op">=</span> <span class="st">&#39;ME&#39;</span>)</span>
<span id="cb71-20"><a href="exponential-smoothing.html#cb71-20" tabindex="-1"></a>air_model <span class="op">=</span> air_holt.fit(df <span class="op">=</span> air_train)</span>
<span id="cb71-21"><a href="exponential-smoothing.html#cb71-21" tabindex="-1"></a></span>
<span id="cb71-22"><a href="exponential-smoothing.html#cb71-22" tabindex="-1"></a>result <span class="op">=</span> air_holt.fitted_[<span class="dv">0</span>,<span class="dv">0</span>].model_[<span class="st">&#39;par&#39;</span>]</span>
<span id="cb71-23"><a href="exponential-smoothing.html#cb71-23" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## array([5.69871723e-01, 1.00000000e-04,            nan,            nan,
##        3.48788866e+04, 1.29335525e+02])</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="exponential-smoothing.html#cb73-1" tabindex="-1"></a>y_hat1<span class="op">=</span>air_model.predict(h<span class="op">=</span><span class="dv">27</span>)</span></code></pre></div>
<pre><code>## C:\PROGRA~3\ANACON~1\Lib\site-packages\statsforecast\core.py:492: FutureWarning: In a future version the predictions will have the id as a column. You can set the `NIXTLA_ID_AS_COL` environment variable to adopt the new behavior and to suppress this warning.
##   warnings.warn(</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="exponential-smoothing.html#cb75-1" tabindex="-1"></a>yhat<span class="op">=</span>y_hat1.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb75-2"><a href="exponential-smoothing.html#cb75-2" tabindex="-1"></a>forecast<span class="op">=</span>pd.Series(pd.date_range(<span class="st">&quot;2006-01-01&quot;</span>, freq<span class="op">=</span><span class="st">&quot;ME&quot;</span>, periods<span class="op">=</span><span class="dv">27</span>))</span>
<span id="cb75-3"><a href="exponential-smoothing.html#cb75-3" tabindex="-1"></a>forecast<span class="op">=</span>pd.DataFrame(forecast)</span>
<span id="cb75-4"><a href="exponential-smoothing.html#cb75-4" tabindex="-1"></a>forecast.columns<span class="op">=</span>[<span class="st">&quot;ds&quot;</span>]</span>
<span id="cb75-5"><a href="exponential-smoothing.html#cb75-5" tabindex="-1"></a>forecast[<span class="st">&quot;hat&quot;</span>]<span class="op">=</span>yhat[<span class="st">&#39;AutoETS&#39;</span>]</span>
<span id="cb75-6"><a href="exponential-smoothing.html#cb75-6" tabindex="-1"></a>forecast[<span class="st">&quot;unique_id&quot;</span>]<span class="op">=</span><span class="st">&quot;1&quot;</span></span>
<span id="cb75-7"><a href="exponential-smoothing.html#cb75-7" tabindex="-1"></a>sns.lineplot(air_train,x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;y&quot;</span>, label<span class="op">=</span><span class="st">&quot;Train&quot;</span>)</span>
<span id="cb75-8"><a href="exponential-smoothing.html#cb75-8" tabindex="-1"></a>sns.lineplot(air_test, x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;y&quot;</span>, label<span class="op">=</span><span class="st">&quot;Test&quot;</span>)</span>
<span id="cb75-9"><a href="exponential-smoothing.html#cb75-9" tabindex="-1"></a>sns.lineplot(forecast,x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;hat&quot;</span>, label<span class="op">=</span><span class="st">&quot;Forecast&quot;</span>,)</span>
<span id="cb75-10"><a href="exponential-smoothing.html#cb75-10" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/holt%20models-5.png" width="672" /></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="exponential-smoothing.html#cb76-1" tabindex="-1"></a><span class="co">### Damped trend</span></span>
<span id="cb76-2"><a href="exponential-smoothing.html#cb76-2" tabindex="-1"></a></span>
<span id="cb76-3"><a href="exponential-smoothing.html#cb76-3" tabindex="-1"></a></span>
<span id="cb76-4"><a href="exponential-smoothing.html#cb76-4" tabindex="-1"></a>air_holt <span class="op">=</span> StatsForecast(models <span class="op">=</span> [AutoETS(model<span class="op">=</span>[<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;N&quot;</span>],  damped<span class="op">=</span><span class="va">True</span>, alias<span class="op">=</span><span class="st">&quot;AutoETS&quot;</span>, season_length<span class="op">=</span><span class="dv">12</span>)], freq <span class="op">=</span> <span class="st">&#39;ME&#39;</span>)</span>
<span id="cb76-5"><a href="exponential-smoothing.html#cb76-5" tabindex="-1"></a>air_model <span class="op">=</span> air_holt.fit(df <span class="op">=</span> air_train)</span>
<span id="cb76-6"><a href="exponential-smoothing.html#cb76-6" tabindex="-1"></a></span>
<span id="cb76-7"><a href="exponential-smoothing.html#cb76-7" tabindex="-1"></a>result <span class="op">=</span> air_holt.fitted_[<span class="dv">0</span>,<span class="dv">0</span>].model_[<span class="st">&#39;par&#39;</span>]</span>
<span id="cb76-8"><a href="exponential-smoothing.html#cb76-8" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## array([5.71199778e-01, 1.00000000e-04,            nan, 9.79993121e-01,
##        3.46022280e+04, 3.16699140e+02])</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="exponential-smoothing.html#cb78-1" tabindex="-1"></a>y_hat1<span class="op">=</span>air_model.predict(h<span class="op">=</span><span class="dv">27</span>)</span></code></pre></div>
<pre><code>## C:\PROGRA~3\ANACON~1\Lib\site-packages\statsforecast\core.py:492: FutureWarning: In a future version the predictions will have the id as a column. You can set the `NIXTLA_ID_AS_COL` environment variable to adopt the new behavior and to suppress this warning.
##   warnings.warn(</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="exponential-smoothing.html#cb80-1" tabindex="-1"></a>yhat<span class="op">=</span>y_hat1.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb80-2"><a href="exponential-smoothing.html#cb80-2" tabindex="-1"></a>forecast<span class="op">=</span>pd.Series(pd.date_range(<span class="st">&quot;2006-01-01&quot;</span>, freq<span class="op">=</span><span class="st">&quot;ME&quot;</span>, periods<span class="op">=</span><span class="dv">27</span>))</span>
<span id="cb80-3"><a href="exponential-smoothing.html#cb80-3" tabindex="-1"></a>forecast<span class="op">=</span>pd.DataFrame(forecast)</span>
<span id="cb80-4"><a href="exponential-smoothing.html#cb80-4" tabindex="-1"></a>forecast.columns<span class="op">=</span>[<span class="st">&quot;ds&quot;</span>]</span>
<span id="cb80-5"><a href="exponential-smoothing.html#cb80-5" tabindex="-1"></a>forecast[<span class="st">&quot;hat&quot;</span>]<span class="op">=</span>yhat[<span class="st">&#39;AutoETS&#39;</span>]</span>
<span id="cb80-6"><a href="exponential-smoothing.html#cb80-6" tabindex="-1"></a>forecast[<span class="st">&quot;unique_id&quot;</span>]<span class="op">=</span><span class="st">&quot;1&quot;</span></span>
<span id="cb80-7"><a href="exponential-smoothing.html#cb80-7" tabindex="-1"></a>sns.lineplot(air_train,x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;y&quot;</span>, label<span class="op">=</span><span class="st">&quot;Train&quot;</span>)</span>
<span id="cb80-8"><a href="exponential-smoothing.html#cb80-8" tabindex="-1"></a>sns.lineplot(air_test, x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;y&quot;</span>, label<span class="op">=</span><span class="st">&quot;Test&quot;</span>)</span>
<span id="cb80-9"><a href="exponential-smoothing.html#cb80-9" tabindex="-1"></a>sns.lineplot(forecast,x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;hat&quot;</span>, label<span class="op">=</span><span class="st">&quot;Forecast&quot;</span>,)</span>
<span id="cb80-10"><a href="exponential-smoothing.html#cb80-10" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/holt%20models-6.png" width="672" /></p>
<p>Seasonal models in Python:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="exponential-smoothing.html#cb81-1" tabindex="-1"></a><span class="co">###  Using Statsforecast</span></span>
<span id="cb81-2"><a href="exponential-smoothing.html#cb81-2" tabindex="-1"></a></span>
<span id="cb81-3"><a href="exponential-smoothing.html#cb81-3" tabindex="-1"></a><span class="co">### Additive Seasonality</span></span>
<span id="cb81-4"><a href="exponential-smoothing.html#cb81-4" tabindex="-1"></a></span>
<span id="cb81-5"><a href="exponential-smoothing.html#cb81-5" tabindex="-1"></a>air_holtw <span class="op">=</span> StatsForecast(models <span class="op">=</span> [AutoETS(model<span class="op">=</span>[<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>],  alias<span class="op">=</span><span class="st">&quot;AutoETS&quot;</span>, season_length<span class="op">=</span><span class="dv">12</span>)], freq <span class="op">=</span> <span class="st">&#39;ME&#39;</span>)</span>
<span id="cb81-6"><a href="exponential-smoothing.html#cb81-6" tabindex="-1"></a>air_model <span class="op">=</span> air_holtw.fit(df <span class="op">=</span> air_train)</span>
<span id="cb81-7"><a href="exponential-smoothing.html#cb81-7" tabindex="-1"></a></span>
<span id="cb81-8"><a href="exponential-smoothing.html#cb81-8" tabindex="-1"></a>result <span class="op">=</span> air_holtw.fitted_[<span class="dv">0</span>,<span class="dv">0</span>].model_[<span class="st">&#39;par&#39;</span>]</span>
<span id="cb81-9"><a href="exponential-smoothing.html#cb81-9" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## array([ 4.81222943e-01,  1.59916114e-02,  2.42485779e-01,  8.90792825e-01,
##         3.77019540e+04,  5.67094839e+02, -9.99248746e+02, -2.53068050e+03,
##         1.17586756e+03, -2.77023876e+03,  5.79529172e+03,  4.08571477e+03,
##         2.44858026e+03, -1.89481694e+02, -5.21476747e+02,  1.96822431e+03,
##        -4.80880072e+03, -3.65375146e+03])</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="exponential-smoothing.html#cb83-1" tabindex="-1"></a>y_hat1<span class="op">=</span>air_model.predict(h<span class="op">=</span><span class="dv">27</span>)</span></code></pre></div>
<pre><code>## C:\PROGRA~3\ANACON~1\Lib\site-packages\statsforecast\core.py:492: FutureWarning: In a future version the predictions will have the id as a column. You can set the `NIXTLA_ID_AS_COL` environment variable to adopt the new behavior and to suppress this warning.
##   warnings.warn(</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="exponential-smoothing.html#cb85-1" tabindex="-1"></a>yhat<span class="op">=</span>y_hat1.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb85-2"><a href="exponential-smoothing.html#cb85-2" tabindex="-1"></a>forecast<span class="op">=</span>pd.Series(pd.date_range(<span class="st">&quot;2006-01-01&quot;</span>, freq<span class="op">=</span><span class="st">&quot;ME&quot;</span>, periods<span class="op">=</span><span class="dv">27</span>))</span>
<span id="cb85-3"><a href="exponential-smoothing.html#cb85-3" tabindex="-1"></a>forecast<span class="op">=</span>pd.DataFrame(forecast)</span>
<span id="cb85-4"><a href="exponential-smoothing.html#cb85-4" tabindex="-1"></a>forecast.columns<span class="op">=</span>[<span class="st">&quot;ds&quot;</span>]</span>
<span id="cb85-5"><a href="exponential-smoothing.html#cb85-5" tabindex="-1"></a>forecast[<span class="st">&quot;hat&quot;</span>]<span class="op">=</span>yhat[<span class="st">&#39;AutoETS&#39;</span>]</span>
<span id="cb85-6"><a href="exponential-smoothing.html#cb85-6" tabindex="-1"></a>forecast[<span class="st">&quot;unique_id&quot;</span>]<span class="op">=</span><span class="st">&quot;1&quot;</span></span>
<span id="cb85-7"><a href="exponential-smoothing.html#cb85-7" tabindex="-1"></a>sns.lineplot(air_train,x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;y&quot;</span>, label<span class="op">=</span><span class="st">&quot;Train&quot;</span>)</span>
<span id="cb85-8"><a href="exponential-smoothing.html#cb85-8" tabindex="-1"></a>sns.lineplot(air_test, x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;y&quot;</span>, label<span class="op">=</span><span class="st">&quot;Test&quot;</span>)</span>
<span id="cb85-9"><a href="exponential-smoothing.html#cb85-9" tabindex="-1"></a>sns.lineplot(forecast,x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;hat&quot;</span>, label<span class="op">=</span><span class="st">&quot;Forecast&quot;</span>,)</span>
<span id="cb85-10"><a href="exponential-smoothing.html#cb85-10" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/seasonal%20models-9.png" width="672" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="exponential-smoothing.html#cb86-1" tabindex="-1"></a><span class="co">### Multiplicative Seasonality</span></span>
<span id="cb86-2"><a href="exponential-smoothing.html#cb86-2" tabindex="-1"></a></span>
<span id="cb86-3"><a href="exponential-smoothing.html#cb86-3" tabindex="-1"></a>air_holtw <span class="op">=</span> StatsForecast(models <span class="op">=</span> [AutoETS(model<span class="op">=</span>[<span class="st">&quot;M&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;M&quot;</span>],  alias<span class="op">=</span><span class="st">&quot;AutoETS&quot;</span>, season_length<span class="op">=</span><span class="dv">12</span>)], freq <span class="op">=</span> <span class="st">&#39;ME&#39;</span>)</span>
<span id="cb86-4"><a href="exponential-smoothing.html#cb86-4" tabindex="-1"></a>air_model <span class="op">=</span> air_holtw.fit(df <span class="op">=</span> air_train)</span>
<span id="cb86-5"><a href="exponential-smoothing.html#cb86-5" tabindex="-1"></a></span>
<span id="cb86-6"><a href="exponential-smoothing.html#cb86-6" tabindex="-1"></a>result <span class="op">=</span> air_holtw.fitted_[<span class="dv">0</span>,<span class="dv">0</span>].model_[<span class="st">&#39;par&#39;</span>]</span>
<span id="cb86-7"><a href="exponential-smoothing.html#cb86-7" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## array([9.45573068e-02, 2.64219583e-03, 2.54391669e-02,            nan,
##        3.72394856e+04, 1.57545432e+02, 9.69302717e-01, 9.46292042e-01,
##        9.96735467e-01, 9.23896361e-01, 1.13023141e+00, 1.12016781e+00,
##        1.07916358e+00, 1.02341081e+00, 1.00200872e+00, 1.04798340e+00,
##        8.69839578e-01, 8.90968112e-01])</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="exponential-smoothing.html#cb88-1" tabindex="-1"></a>y_hat1<span class="op">=</span>air_model.predict(h<span class="op">=</span><span class="dv">27</span>)</span></code></pre></div>
<pre><code>## C:\PROGRA~3\ANACON~1\Lib\site-packages\statsforecast\core.py:492: FutureWarning: In a future version the predictions will have the id as a column. You can set the `NIXTLA_ID_AS_COL` environment variable to adopt the new behavior and to suppress this warning.
##   warnings.warn(</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="exponential-smoothing.html#cb90-1" tabindex="-1"></a>yhat<span class="op">=</span>y_hat1.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb90-2"><a href="exponential-smoothing.html#cb90-2" tabindex="-1"></a>forecast<span class="op">=</span>pd.Series(pd.date_range(<span class="st">&quot;2006-01-01&quot;</span>, freq<span class="op">=</span><span class="st">&quot;ME&quot;</span>, periods<span class="op">=</span><span class="dv">27</span>))</span>
<span id="cb90-3"><a href="exponential-smoothing.html#cb90-3" tabindex="-1"></a>forecast<span class="op">=</span>pd.DataFrame(forecast)</span>
<span id="cb90-4"><a href="exponential-smoothing.html#cb90-4" tabindex="-1"></a>forecast.columns<span class="op">=</span>[<span class="st">&quot;ds&quot;</span>]</span>
<span id="cb90-5"><a href="exponential-smoothing.html#cb90-5" tabindex="-1"></a>forecast[<span class="st">&quot;hat&quot;</span>]<span class="op">=</span>yhat[<span class="st">&#39;AutoETS&#39;</span>]</span>
<span id="cb90-6"><a href="exponential-smoothing.html#cb90-6" tabindex="-1"></a>forecast[<span class="st">&quot;unique_id&quot;</span>]<span class="op">=</span><span class="st">&quot;1&quot;</span></span>
<span id="cb90-7"><a href="exponential-smoothing.html#cb90-7" tabindex="-1"></a>sns.lineplot(air_train,x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;y&quot;</span>, label<span class="op">=</span><span class="st">&quot;Train&quot;</span>)</span>
<span id="cb90-8"><a href="exponential-smoothing.html#cb90-8" tabindex="-1"></a>sns.lineplot(air_test, x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;y&quot;</span>, label<span class="op">=</span><span class="st">&quot;Test&quot;</span>)</span>
<span id="cb90-9"><a href="exponential-smoothing.html#cb90-9" tabindex="-1"></a>sns.lineplot(forecast,x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;hat&quot;</span>, label<span class="op">=</span><span class="st">&quot;Forecast&quot;</span>,)</span>
<span id="cb90-10"><a href="exponential-smoothing.html#cb90-10" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/seasonal%20models-10.png" width="672" /></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb91-1"><a href="exponential-smoothing.html#cb91-1" tabindex="-1"></a><span class="co">### AutoETS</span></span>
<span id="cb91-2"><a href="exponential-smoothing.html#cb91-2" tabindex="-1"></a></span>
<span id="cb91-3"><a href="exponential-smoothing.html#cb91-3" tabindex="-1"></a>air_holtw <span class="op">=</span> StatsForecast(models <span class="op">=</span> [AutoETS(model<span class="op">=</span>[<span class="st">&quot;Z&quot;</span>,<span class="st">&quot;Z&quot;</span>,<span class="st">&quot;Z&quot;</span>],  alias<span class="op">=</span><span class="st">&quot;AutoETS&quot;</span>, season_length<span class="op">=</span><span class="dv">12</span>)], freq <span class="op">=</span> <span class="st">&#39;ME&#39;</span>)</span>
<span id="cb91-4"><a href="exponential-smoothing.html#cb91-4" tabindex="-1"></a>air_model <span class="op">=</span> air_holtw.fit(df <span class="op">=</span> air_train)</span>
<span id="cb91-5"><a href="exponential-smoothing.html#cb91-5" tabindex="-1"></a></span>
<span id="cb91-6"><a href="exponential-smoothing.html#cb91-6" tabindex="-1"></a>result <span class="op">=</span> air_holtw.fitted_[<span class="dv">0</span>,<span class="dv">0</span>].model_[<span class="st">&#39;par&#39;</span>]</span>
<span id="cb91-7"><a href="exponential-smoothing.html#cb91-7" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## array([ 3.53928248e-01,             nan,  2.91330703e-01,             nan,
##         3.88348407e+04, -8.30637153e+02, -2.79366612e+03,  3.48960549e+02,
##        -1.64504368e+03,  6.41938336e+03,  5.16183884e+03,  2.80318982e+03,
##         1.24549104e+02, -1.04962061e+03,  9.50906067e+02, -5.57370399e+03,
##        -3.91615619e+03])</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="exponential-smoothing.html#cb93-1" tabindex="-1"></a>y_hat1<span class="op">=</span>air_model.predict(h<span class="op">=</span><span class="dv">27</span>)</span></code></pre></div>
<pre><code>## C:\PROGRA~3\ANACON~1\Lib\site-packages\statsforecast\core.py:492: FutureWarning: In a future version the predictions will have the id as a column. You can set the `NIXTLA_ID_AS_COL` environment variable to adopt the new behavior and to suppress this warning.
##   warnings.warn(</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="exponential-smoothing.html#cb95-1" tabindex="-1"></a>yhat<span class="op">=</span>y_hat1.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb95-2"><a href="exponential-smoothing.html#cb95-2" tabindex="-1"></a>forecast<span class="op">=</span>pd.Series(pd.date_range(<span class="st">&quot;2006-01-01&quot;</span>, freq<span class="op">=</span><span class="st">&quot;ME&quot;</span>, periods<span class="op">=</span><span class="dv">27</span>))</span>
<span id="cb95-3"><a href="exponential-smoothing.html#cb95-3" tabindex="-1"></a>forecast<span class="op">=</span>pd.DataFrame(forecast)</span>
<span id="cb95-4"><a href="exponential-smoothing.html#cb95-4" tabindex="-1"></a>forecast.columns<span class="op">=</span>[<span class="st">&quot;ds&quot;</span>]</span>
<span id="cb95-5"><a href="exponential-smoothing.html#cb95-5" tabindex="-1"></a>forecast[<span class="st">&quot;hat&quot;</span>]<span class="op">=</span>yhat[<span class="st">&#39;AutoETS&#39;</span>]</span>
<span id="cb95-6"><a href="exponential-smoothing.html#cb95-6" tabindex="-1"></a>forecast[<span class="st">&quot;unique_id&quot;</span>]<span class="op">=</span><span class="st">&quot;1&quot;</span></span>
<span id="cb95-7"><a href="exponential-smoothing.html#cb95-7" tabindex="-1"></a>sns.lineplot(air_train,x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;y&quot;</span>, label<span class="op">=</span><span class="st">&quot;Train&quot;</span>)</span>
<span id="cb95-8"><a href="exponential-smoothing.html#cb95-8" tabindex="-1"></a>sns.lineplot(air_test, x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;y&quot;</span>, label<span class="op">=</span><span class="st">&quot;Test&quot;</span>)</span>
<span id="cb95-9"><a href="exponential-smoothing.html#cb95-9" tabindex="-1"></a>sns.lineplot(forecast,x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;hat&quot;</span>, label<span class="op">=</span><span class="st">&quot;Forecast&quot;</span>,)</span>
<span id="cb95-10"><a href="exponential-smoothing.html#cb95-10" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/seasonal%20models-11.png" width="672" /></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb96-1"><a href="exponential-smoothing.html#cb96-1" tabindex="-1"></a><span class="co">### Comparing models:</span></span>
<span id="cb96-2"><a href="exponential-smoothing.html#cb96-2" tabindex="-1"></a></span>
<span id="cb96-3"><a href="exponential-smoothing.html#cb96-3" tabindex="-1"></a>air_holtw <span class="op">=</span> StatsForecast(models <span class="op">=</span> [AutoETS(model<span class="op">=</span>[<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>], alias <span class="op">=</span> <span class="st">&quot;Additive&quot;</span>, season_length<span class="op">=</span><span class="dv">12</span>), </span>
<span id="cb96-4"><a href="exponential-smoothing.html#cb96-4" tabindex="-1"></a>                                    AutoETS(model<span class="op">=</span>[<span class="st">&quot;M&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;M&quot;</span>], alias <span class="op">=</span> <span class="st">&quot;Multiplicative&quot;</span>,   season_length<span class="op">=</span><span class="dv">12</span>)], freq <span class="op">=</span> <span class="st">&#39;ME&#39;</span>)</span>
<span id="cb96-5"><a href="exponential-smoothing.html#cb96-5" tabindex="-1"></a>air_model <span class="op">=</span> air_holtw.fit(df <span class="op">=</span> air_train)</span>
<span id="cb96-6"><a href="exponential-smoothing.html#cb96-6" tabindex="-1"></a></span>
<span id="cb96-7"><a href="exponential-smoothing.html#cb96-7" tabindex="-1"></a></span>
<span id="cb96-8"><a href="exponential-smoothing.html#cb96-8" tabindex="-1"></a>y_hat1<span class="op">=</span>air_model.predict(h<span class="op">=</span><span class="dv">27</span>)</span></code></pre></div>
<pre><code>## C:\PROGRA~3\ANACON~1\Lib\site-packages\statsforecast\core.py:492: FutureWarning: In a future version the predictions will have the id as a column. You can set the `NIXTLA_ID_AS_COL` environment variable to adopt the new behavior and to suppress this warning.
##   warnings.warn(</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb98-1"><a href="exponential-smoothing.html#cb98-1" tabindex="-1"></a>y_hat1</span></code></pre></div>
<pre><code>##                   ds      Additive  Multiplicative
## unique_id                                         
## 1         2005-12-31  55463.046875    55276.296875
## 1         2006-01-31  54885.386719    54177.058594
## 1         2006-02-28  65846.859375    65606.875000
## 1         2006-03-31  62177.195312    62759.925781
## 1         2006-04-30  63248.167969    64265.078125
## 1         2006-05-31  66142.429688    67983.453125
## 1         2006-06-30  68683.671875    71003.070312
## 1         2006-07-31  66152.406250    71539.562500
## 1         2006-08-31  54251.707031    58415.742188
## 1         2006-09-30  59907.390625    63461.949219
## 1         2006-10-31  58180.179688    60389.761719
## 1         2006-11-30  59900.917969    62076.480469
## 1         2006-12-31  55417.457031    57164.699219
## 1         2007-01-31  54844.781250    56022.656250
## 1         2007-02-28  65810.687500    67835.507812
## 1         2007-03-31  62144.972656    64885.832031
## 1         2007-04-30  63219.460938    66435.843750
## 1         2007-05-31  66116.859375    70273.367188
## 1         2007-06-30  68660.890625    73388.007812
## 1         2007-07-31  66132.117188    73935.812500
## 1         2007-08-31  54233.632812    60366.957031
## 1         2007-09-30  59891.289062    65575.835938
## 1         2007-10-31  58165.839844    62395.746094
## 1         2007-11-30  59888.144531    64132.800781
## 1         2007-12-31  55406.078125    59053.101562
## 1         2008-01-31  54834.640625    57868.250000
## 1         2008-02-29  65801.656250    70064.148438</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="exponential-smoothing.html#cb100-1" tabindex="-1"></a>y_hat1<span class="op">=</span>air_model.predict(h<span class="op">=</span><span class="dv">27</span>)</span></code></pre></div>
<pre><code>## C:\PROGRA~3\ANACON~1\Lib\site-packages\statsforecast\core.py:492: FutureWarning: In a future version the predictions will have the id as a column. You can set the `NIXTLA_ID_AS_COL` environment variable to adopt the new behavior and to suppress this warning.
##   warnings.warn(</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="exponential-smoothing.html#cb102-1" tabindex="-1"></a>yhat<span class="op">=</span>y_hat1.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb102-2"><a href="exponential-smoothing.html#cb102-2" tabindex="-1"></a>forecast<span class="op">=</span>pd.Series(pd.date_range(<span class="st">&quot;2006-01-01&quot;</span>, freq<span class="op">=</span><span class="st">&quot;ME&quot;</span>, periods<span class="op">=</span><span class="dv">27</span>))</span>
<span id="cb102-3"><a href="exponential-smoothing.html#cb102-3" tabindex="-1"></a>forecast<span class="op">=</span>pd.DataFrame(forecast)</span>
<span id="cb102-4"><a href="exponential-smoothing.html#cb102-4" tabindex="-1"></a>forecast.columns<span class="op">=</span>[<span class="st">&quot;ds&quot;</span>]</span>
<span id="cb102-5"><a href="exponential-smoothing.html#cb102-5" tabindex="-1"></a>forecast[<span class="st">&quot;hat1&quot;</span>]<span class="op">=</span>yhat[<span class="st">&#39;Additive&#39;</span>]</span>
<span id="cb102-6"><a href="exponential-smoothing.html#cb102-6" tabindex="-1"></a>forecast[<span class="st">&quot;hat2&quot;</span>]<span class="op">=</span>yhat[<span class="st">&#39;Multiplicative&#39;</span>]</span>
<span id="cb102-7"><a href="exponential-smoothing.html#cb102-7" tabindex="-1"></a>forecast[<span class="st">&quot;unique_id&quot;</span>]<span class="op">=</span><span class="st">&quot;1&quot;</span></span>
<span id="cb102-8"><a href="exponential-smoothing.html#cb102-8" tabindex="-1"></a>sns.lineplot(air_train,x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;y&quot;</span>, label<span class="op">=</span><span class="st">&quot;Train&quot;</span>)</span>
<span id="cb102-9"><a href="exponential-smoothing.html#cb102-9" tabindex="-1"></a>sns.lineplot(air_test, x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;y&quot;</span>, label<span class="op">=</span><span class="st">&quot;Test&quot;</span>)</span>
<span id="cb102-10"><a href="exponential-smoothing.html#cb102-10" tabindex="-1"></a>sns.lineplot(forecast,x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;hat1&quot;</span>, label<span class="op">=</span><span class="st">&quot;Additive&quot;</span>)</span>
<span id="cb102-11"><a href="exponential-smoothing.html#cb102-11" tabindex="-1"></a>sns.lineplot(forecast,x<span class="op">=</span><span class="st">&quot;ds&quot;</span>, y<span class="op">=</span><span class="st">&quot;hat2&quot;</span>, label<span class="op">=</span><span class="st">&quot;Multiplicative&quot;</span>)</span>
<span id="cb102-12"><a href="exponential-smoothing.html#cb102-12" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/seasonal%20models-12.png" width="672" /></p>
</div>
<div id="sas-code-for-exponential-smoothing-models" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> SAS Code for Exponential Smoothing Models<a href="exponential-smoothing.html#sas-code-for-exponential-smoothing-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following code is for Exponential Smoothing models in SAS.</p>
<p><em>Create library for data sets</em>
libname Time ‘Q:Drive - Time Series’;<br />
run;</p>
<p><em>SIMPLE EXPONENTIAL SMOOTHING MODEL</em></p>
<p><em>Create a simple exponential smoothing model</em></p>
<p>proc esm data=Time.Steel print=all plot=all lead=24;<br />
forecast steelshp / model=simple;<br />
run;</p>
<p><em>Create a simple exponential smoothing model with ID statement</em>  </p>
<p>proc esm data=Time.USAirlines print=all plot=all lead=24;  
id date interval=month;  
forecast Passengers / model=simple;  
run;  </p>
<p><em>LINEAR TREND FOR EXPONENTIAL SMOOTHING</em>  </p>
<p><em>Double exponential smoothing</em>  </p>
<p>proc esm data=Time.Steel print=all plot=all lead=24;  
forecast steelshp / model=double;  
run;  </p>
<p><em>linear exponential smoothing</em>  </p>
<p>proc esm data=Time.Steel print=all plot=all lead=24;  
forecast steelshp / model=linear;  
run;  </p>
<p><em>damped trend exponential smoothing</em>  </p>
<p>proc esm data=Time.Steel print=all plot=all lead=24;  
forecast steelshp / model=damptrend;  
run;  </p>
<p><em>linear exponential smoothign with interval = month</em>  </p>
<p>proc esm data=Time.USAirlines print=all plot=all lead=24;  
id date interval=month;  
forecast Passengers / model=linear;  
run;  </p>
<p><em>SEASONAL EXPONENTIAL SMOOTHING MODEL</em>  </p>
<p><em>Additive seasonal exponential smoothing model</em>  </p>
<p>proc esm data=Time.USAirlines print=all plot=all  
seasonality=12 lead=24 outfor=test1;  
forecast Passengers / model=addseasonal;  
run;  </p>
<p><em>mulitplicative seasonal exponential smoothing model</em>  </p>
<p>proc esm data=Time.USAirlines print=all plot=all  
seasonality=12 lead=24;  
forecast Passengers / model=multseasonal;  
run;  </p>
<p><em>Winters additive exponential smoothing model (includes trend)</em>  </p>
<p>proc esm data=Time.USAirlines print=all plot=all  
seasonality=12 lead=24;  
forecast Passengers / model=addwinters;  
run;  </p>
<p><em>Winters multiplicative exponential smoothing model (includes trend) (Lead = 24)</em>  </p>
<p>proc esm data=Time.USAirlines print=all plot=all  
seasonality=12 lead=24;  
forecast Passengers / model=multwinters;  
run;  </p>
<p><em>Winters multiplicative exponential smoothing model (includes trend) Lead = 12</em>  </p>
<p>proc esm data=Time.USAirlines print=all plot=all lead=12  
back=12 seasonality=12;  
forecast Passengers / model=multwinters;  
run;  </p>
<p><em>EXPLORATION of SEASONAL EXPONENTIAL SMOOTHING MODEL</em>  </p>
<p><em>Winters multiplicative exponential smoothing model (includes trend) Lead = 12, uses outfor statement to output forecasts</em>  </p>
<p>proc esm data=Time.USAirlines print=all plot=all<br />
seasonality=12 lead=12 back=12 outfor=test;  
forecast Passengers / model=multwinters;  
run;  </p>
<p><em>calculate |error|/|actual value|</em>  </p>
<p>data test2;  
set test;  
if <em>TIMEID</em>&gt;207;  
abs_error=abs(error);  
abs_err_obs=abs_error/abs(actual);  
run;  </p>
<p><em>mean of |error|/|actual value| for this forecast</em>  </p>
<p>proc means data=test2 mean;  
var abs_error abs_err_obs;  
run;</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="arima.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/sjsimmo2/TimeSeries/edit/master/02-Exponential-Smoothing.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/sjsimmo2/TimeSeries/blob/master/02-Exponential-Smoothing.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
